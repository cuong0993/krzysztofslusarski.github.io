---
layout: default
title:  "[Java][JVM Logs] Monday with JVM logs - introduction and safepoints logs"
date:   2021-07-16 09:51:30 +0100
---

# [Java][JVM Logs] Monday with the JVM logs - introduction and safepoints logs
THe JVM logs are **the powerful source of the knowledge** how our application works on the virtual machine.
Unfortunately they are not very well documented. In this series of articles I will try to show you what you can
read from them. I will not cover how the JVM works, but I will add references if I have one.

All charts that you will find in the series are generated by my 
[open-source project](https://github.com/krzysztofslusarski/jvm-gc-logs-analyzer){:target="_blank"}.

## Reference - how safepoints work?

[My previous article about the STW phase](https://krzysztofslusarski.github.io/2020/11/13/stw.html){:target="_blank"}

[YouTube - With GC Solved, What Else Makes a JVM Pause?](https://www.youtube.com/watch?v=Y39kllzX1P8){:target="_blank"}

## Logging

_Safepoints_ has dedicated logs in a _unified logger_. You can enable it with ```Xlog:safepoint```. A following example comes
from **Java 11**:

```
[safepoint        ] Application time: 0.1950250 seconds
[safepoint        ] Entering safepoint region: RevokeBias
[safepoint        ] Leaving safepoint region
[safepoint        ] Total time for which application threads were stopped: 0.0003424 seconds, Stopping threads took: 0.0000491 seconds
```

A little bit of explanation what that means:
* First line "Application time: **0.1950250**": this is a time from last STW phase
* Second line "Entering safepoint region: **RevokeBias**": this is a name of _safepoint operation_ that needed STW phase
* Last line "Total time for which application threads were stopped: **0.0003424**": this is a sum of _time to safepoint_ and _safepoint operation time_
* Last line "Stopping threads took: **0.0000491**": this is a  _time to safepoint_

The format is different in **Java 8** and **Java >= 13**, but other formats contain the same information.

## _The mother of all chats_

When I profile an application that is running at the JVM the first chart I'm looking at is the chart that shows me
in **2 seconds window** how much time was wasted by the **stop-the-world** phases. Drawing that chart is a little pain
in the ass, but my _JVM logs viewer_ has such a functionality.

### Why **2 seconds**?

The window size depends on the context. I usually profile applications which response time should be less than 
**2 seconds**.

### Examples

How you would like that chart to look like:

![alt text](/assets/monday-1/1.jpg "1")

That charts show **12 days** of the very huge application. This charts shows that **in 2 seconds window** that 
application always runs over **1.8** seconds, usually over **1.9** seconds.

The other example for a small application:
![alt text](/assets/monday-1/2.jpg "2")


